.PHONY: help dev dev-auth dev-game dev-data dev-web stop clean build restore

help:
	@echo "Location404 - Makefile Commands"
	@echo ""
	@echo "  make dev          - Roda todos os 4 serviÃ§os em paralelo"
	@echo "  make dev-auth     - Roda apenas o Auth Service"
	@echo "  make dev-game     - Roda apenas o Game Service"
	@echo "  make dev-data     - Roda apenas o Data Service"
	@echo "  make dev-web      - Roda apenas o Frontend (Vue)"
	@echo "  make build        - Build todos os projetos backend"
	@echo "  make restore      - Restore dependencies de todos os projetos"
	@echo "  make clean        - Limpa builds anteriores"
	@echo "  make stop         - Para todos os processos rodando"

dev:
	@echo "ğŸš€ Iniciando todos os serviÃ§os..."
	@make -j4 dev-auth dev-game dev-data dev-web

dev-auth:
	@echo "ğŸ” Iniciando Auth Service..."
	@cd location404-auth/src/Location404.Auth.API && dotnet run

dev-game:
	@echo "ğŸ® Iniciando Game Service..."
	@cd location404-game/src/Location404.Game.API && dotnet run

dev-data:
	@echo "ğŸ“Š Iniciando Data Service..."
	@cd location404-data/src/Location404.Data.API && dotnet run

dev-web:
	@echo "ğŸŒ Iniciando Frontend..."
	@cd location404-web && npm run dev

build:
	@echo "ğŸ”¨ Building Auth Service..."
	@cd location404-auth && dotnet build
	@echo "ğŸ”¨ Building Game Service..."
	@cd location404-game && dotnet build
	@echo "ğŸ”¨ Building Data Service..."
	@cd location404-data && dotnet build
	@echo "ğŸ”¨ Building Frontend..."
	@cd location404-web && npm run build

restore:
	@echo "ğŸ“¦ Restoring Auth Service..."
	@cd location404-auth && dotnet restore
	@echo "ğŸ“¦ Restoring Game Service..."
	@cd location404-game && dotnet restore
	@echo "ğŸ“¦ Restoring Data Service..."
	@cd location404-data && dotnet restore
	@echo "ğŸ“¦ Installing Frontend dependencies..."
	@cd location404-web && npm install

clean:
	@echo "ğŸ§¹ Limpando builds..."
	@cd location404-auth && dotnet clean
	@cd location404-game && dotnet clean
	@cd location404-data && dotnet clean
	@cd location404-web && rm -rf dist node_modules/.vite
	@echo "âœ… Limpeza concluÃ­da"

stop:
	@echo "ğŸ›‘ Parando todos os processos..."
	@pkill -f "dotnet run" || true
	@pkill -f "vite" || true
	@echo "âœ… Processos parados"
